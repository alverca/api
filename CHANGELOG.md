# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/).

## Unreleased

### Added

### Changed

### Deprecated

### Removed

### Fixed

### Security

## v10.0.1 - 2019-07-01

### Changed

- 予約変更時に更新日時を連携

## v10.0.0 - 2019-07-01

### Changed

- 予約の入場以外の全属性をChevre化
- 券種インターフェースをChevre化

## v9.0.0 - 2019-06-27

### Removed

- 予約インターフェースから不要な属性を削除
- 予約コレクションからqr_strに対するユニークインデックスを削除

## v8.1.0 - 2019-06-25

### Changed

- 予約検索条件に更新日時を追加

## v8.0.0 - 2019-06-25

### Removed

- 券種からキャンセルチャージ属性を削除
- 予約インターフェースから不要な属性を削除
- 予約検索条件インターフェースから不要な属性を削除

## v7.1.1 - 2019-06-23

### Changed

- 予約検索条件にイベント終了日時を追加

## v7.1.0 - 2019-06-23

### Changed

- 予約検索条件にイベント終了日時を追加

## v7.0.0 - 2019-06-22

### Changed

- 予約データをChevreインターフェースへ変換する処理を追加

## v6.2.0 - 2019-06-18

### Changed

- パフォーマンスインターフェースを拡張

## v6.1.0 - 2019-06-14

### Changed

- 予約検索条件を拡張
- 車椅子の余分確保分を予約として作成するように調整

### Removed

- 在庫インターフェースを削除

## v6.0.2 - 2019-06-12

### Changed

- 券種のchargeをpriceSpecificationに置換

## v6.0.1 - 2019-06-11

### Changed

- 券種のchargeをpriceSpecificationに置換

## v6.0.0 - 2019-06-10

### Added

- 予約distinct検索追加
- 予約キャンセル追加
- パフォーマンス拡張属性更新を追加
- イベント予約集計タスクを追加

### Changed

- パフォーマンス検索条件から作品関係を削除
- パフォーマンスコレクションからリレーションを削除
- 予約リポジトリのmongooseモデルをprivate化
- パフォーマンスリポジトリのmongooseモデルをprivate化
- 新しいRedis在庫リポジトリで再構築
- 予約検索条件調整
- パフォーマンスインターフェースをChevre化に向けて補強
- 新しい一時イベントリポジトリで再構築
- スクリーンに車椅子タイプ座席をひとつ持つように設計調整

### Removed

- 劇場、スクリーン、作品、券種、券種グループコレクションを削除(一時的に動的データ管理を不可能に変更)
- GMO通知コレクションを削除
- SendGridイベントコレクションを削除
- パフォーマンスデータから不要な項目を削除
- 一時イベントオファーリポジトリを削除

## v5.9.0 - 2019-05-26

### Added

- プロジェクトルーターを追加

## v5.8.0 - 2019-04-19

### Added

- WAITER無効化フラグを追加
- IAMルーターを追加

### Changed

- 取引コレクションのインデックス調整
- 予約インターフェースをChevreを継承するように拡張
- 組織コレクションのインデックス調整
- 注文取引の購入者プロフィール情報の持ち方をCinerinoに統一
- install mongoose@5.5.1
- install @motionpicture/ttts-domain@13.5.0

## v5.7.1 - 2019-04-15

### Changed

- イベント検索を最低限の検索条件対応で実装

## v5.7.0 - 2019-04-15

### Added

- ヘルスルーターを追加
- 統計ルーターを追加
- イベントルーターを追加

## v5.6.0 - 2019-03-29

### Added

- 販売者ルーターを追加

## v5.5.1 - 2018-12-26

### Fixed

- アプリケーションによるWAITER必須設定を再追加

## v5.5.0 - 2018-12-23

### Added

- 注文検索を追加
- タスク検索を追加
- 取引検索を追加

## v5.4.8 - 2018-12-11

### Fixed

- moment-timezoneを適切にrequireできていないコードを修正

## v5.4.7 - 2018-12-10

### Changed

- 複数のWAITER許可証発行者に対応

## v5.4.6 - 2018-11-28

### Changed

- 入場イベントを注文レポートへ連動

## v5.4.5 - 2018-06-25

### Fixed

- 返品処理のクエリを調整

## v5.4.4 - 2018-03-22

### Added

- 決済方法に手売りを追加。

## v5.4.3 - 2018-02-14
### Changed
- 予約スキーマに注文取引主体属性を追加。

### Fixed
- 注文取引確定時の注文番号重複エラーをAlreadyInUseエラーとしてハンドリング。

## v5.4.2 - 2018-02-02
### Fixed
- 購入者情報として日本以外の国の電話番号が登録できないバグを修正。
- 同じ上演日で購入番号が重複するバグを修正。

## v5.4.1 - 2018-01-19
### Changed
- 注文取引開始時にstaffアプリケーションに関しては特別に許可証を非必須化(一時的な対応)

## v5.4.0 - 2018-01-19
### Changed
- 注文取引開始時のWAITER許可証を必須化。

## v5.3.0 - 2018-01-17
### Changed
- 予約の属性に在庫情報リストを追加。

## v5.2.1 - 2018-01-15
### Changed
- GMOオーソリタイムアウトハンドリングを調整。

## v5.2.0 - 2018-01-11
### Changed
- 管理者トークンエンドポイントにクライアントによるベーシック認証を追加。
- イベント検索のパフォーマンス向上。

## v5.1.0 - 2018-01-10
### Added
- 管理者トークン発行エンドポイントを追加。
- 管理者エンドポイントを追加。

## v5.0.0 - 2018-01-10
### Added
- クライアント認証の仕組みを実装。
- 許可スコープチェックの仕組みを実装。
- 取引ルーターを追加。
- 座席仮予約エンドポイントを追加。
- 座席仮予約解除エンドポイントを追加。
- 座席本予約エンドポイントを追加。
- 座席本予約取消エンドポイントを追加。
- IDでパフォーマンス検索のエンドポイントを追加。
- 識別子で企業組織検索のエンドポイントを追加。
- 注文照会エンドポイントを追加。
- 入場(取消)エンドポイントを追加。
- 予約検索エンドポイントを追加。

### Changed
- パフォーマンス検索のレスポンスを多言語化。
- HTTPステータスコードの振り分けをルーターに記述するように統一。
- ttts-domain@12.0.0に対応。
- APIの認証情報をCognitoから取得するように変更。
- パフォーマンス検索結果の券種情報を強化。在庫状況情報も強化。
- multi issuer対応。
- 取引にAPIクライアント情報を結合。
- 返品確定サービスを購入者区分に関わらず汎用化。
- 注文取引確定のレスポンスに属性追加。

### Removed
- configパッケージを削除。環境依存変数を全てprocess.envへ移行。
- 不要なルーターを削除。

### Security
- update package [tslint@5.8.0](https://www.npmjs.com/package/tslint)
- update package [typescript@2.6.2](https://www.npmjs.com/package/typescript)

## v4.0.0 - 2017-05-05
### Added
- chevreを継承してリリース。
